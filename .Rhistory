S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-c(S1,S2)
sample<-append(sample,zones)
View(sample)
sample<-list.converted$S_2501_0001.B00
tr.s1<-s.seq(min(sample[["Pyrolysis"]]["t"]),sample[["Cursors"]]["curs1.1"])
tr.s2<-s.seq(sample[["Cursors"]]["curs1.1"],max(sample[["Pyrolysis"]]["t"]))
S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-list(S1,S2)
sample<-append(sample,zones)
View(sample)
####
sample<-list.converted$S_2501_0001.B00
View(sample)
tr.s1<-s.seq(min(sample[["Pyrolysis"]]["t"]),sample[["Cursors"]]["curs1.1"])
tr.s2<-s.seq(sample[["Cursors"]]["curs1.1"],max(sample[["Pyrolysis"]]["t"]))
S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-list(S1,S2)
sample<-append(sample,zones)
sample<-list.converted$S_2501_0001.B00
tr.s1<-s.seq(min(sample[["Pyrolysis"]]["t"]),sample[["Cursors"]]["curs1.1"])
tr.s2<-s.seq(sample[["Cursors"]]["curs1.1"],max(sample[["Pyrolysis"]]["t"]))
S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-list(S1=S1,S2=S2)
sample<-append(sample,zones)
rm(sample)
####
sample<-list.converted$S_2501_0001.B00
tr.s1<-s.seq(min(sample[["Pyrolysis"]]["t"]),sample[["Cursors"]]["curs1.1"])
tr.s2<-s.seq(sample[["Cursors"]]["curs1.1"],max(sample[["Pyrolysis"]]["t"]))
S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-list(S1=S1,S2=S2)
sample<-append(sample,zones)
sample<-
length(sample)
sample<-list.converted$S_2501_0001.B00
tr.s1<-s.seq(min(sample[["Pyrolysis"]]["t"]),sample[["Cursors"]]["curs1.1"])
tr.s2<-s.seq(sample[["Cursors"]]["curs1.1"],max(sample[["Pyrolysis"]]["t"]))
S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-list(S1=S1,S2=S2)
length(sample)
sample<-list.converted$S_2501_0001.B00
tr.s1<-s.seq(min(sample[["Pyrolysis"]]["t"]),sample[["Cursors"]]["curs1.1"])
tr.s2<-s.seq(sample[["Cursors"]]["curs1.1"],max(sample[["Pyrolysis"]]["t"]))
S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-c(S1=S1,S2=S2)
sample[length(sample)+1]<-zones
sample<-list.converted$S_2501_0001.B00
tr.s1<-s.seq(min(sample[["Pyrolysis"]]["t"]),sample[["Cursors"]]["curs1.1"])
tr.s2<-s.seq(sample[["Cursors"]]["curs1.1"],max(sample[["Pyrolysis"]]["t"]))
S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-list(S1=S1,S2=S2)
sample[length(sample)+1]<-zones
View(sample)
####
sample<-list.converted$S_2501_0001.B00
tr.s1<-s.seq(min(sample[["Pyrolysis"]]["t"]),sample[["Cursors"]]["curs1.1"])
tr.s2<-s.seq(sample[["Cursors"]]["curs1.1"],max(sample[["Pyrolysis"]]["t"]))
S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-list(S1=S1,S2=S2)
View(sample)
sample[[length(sample)+1]]<-zones
####
sample<-list.converted$S_2501_0001.B00
tr.s1<-s.seq(min(sample[["Pyrolysis"]]["t"]),sample[["Cursors"]]["curs1.1"])
tr.s2<-s.seq(sample[["Cursors"]]["curs1.1"],max(sample[["Pyrolysis"]]["t"]))
S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-list(S1=S1,S2=S2)
sample[["Zones"]]<-zones
sample<-list.converted$S_2501_0001.B00
tr.s1<-s.seq(min(sample[["Pyrolysis"]]["t"]),sample[["Cursors"]]["curs1.1"])
tr.s2<-s.seq(sample[["Cursors"]]["curs1.1"],max(sample[["Pyrolysis"]]["t"]))
S1<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s1],sample[["Pyrolysis"]][["CH"]][tr.s1])
S2<-RE_traparea(sample[["Pyrolysis"]][["t"]][tr.s2],sample[["Pyrolysis"]][["CH"]][tr.s2])
zones<-c(S1=S1,S2=S2)
sample[["Zones"]]<-zones
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
test2<-RE_convert(test)
test3<-RE_surfaces(test2)
warnings()
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
test2<-RE_convert(test)
test3<-RE_surfaces(test2)
View(test3)
RE_plot(test2)
RE_plot(test)
RE_plot(test,"S_2501_0035.B00")
RE_plot(test2,"S_2501_0035.B00")
sample<-test2$S_2501_0001.B00
tr.s4CO<-s.seq(min(sample[["Oxidation"]]["t"]),sample[["Cursors"]]["curs4.4"])
#1.2 define safe sequence in case of NAs
s.seq<-function(x,y){
if (all(is.na(x))|all(is.na(y))) {NA} else {
seq(x,y,by=1)}
}
tr.s4CO<-s.seq(min(sample[["Oxidation"]]["t"]),sample[["Cursors"]]["curs4.4"])
tr.s4COi<-s.seq(sample[["Cursors"]]["curs4.4"],max(sample[["Oxidation"]]["t"]))
tr.s4CO2<-s.seq(min(sample[["Oxidation"]]["t"]),sample[["Cursors"]]["curs5.4"])
tr.s5<-s.seq(sample[["Cursors"]]["curs5.4"],max(sample[["Oxidation"]]["t"]))
sample[["Cursors"]]["curs5.4"]
sample[["Cursors"]]
View(test3)
#
cursLU<-data.frame(
curs=c(
paste0("curs1.",1:6),
"base1",
paste0("curs2.",1:3),
"base2",
paste0("curs3.",1:3),
"base3",
paste0("curs4.",1:4),
"base4",
paste0("curs5.",1:4),
"base5",
paste0("curs6.",1:5),
"base6",
paste0("curs7.",1:5),
"base7"))
cursLU$type<-substr(cursLU$curs,1,4)
cursLU$oven<-c(
rep("Pyrolysis",7),
rep("Pyrolysis",4),
rep("Pyrolysis",4),
rep("Oxidation",5),
rep("Oxidation",5),
rep("Pyrolysis",6),
rep("Oxidation",6))
cursLU$thermo<-c(
rep("CH",7),
rep("CO",4),
rep("CO2",4),
rep("CO",5),
rep("CO2",5),
rep("SO2",6),
rep("SO2",6))
cursLU<-data.frame(
curs=c(
paste0("curs1.",1:6),
"base1",
paste0("curs2.",1:3),
"base2",
paste0("curs3.",1:3),
"base3",
paste0("curs4.",1:4),
"base4",
paste0("curs5.",1:4),
"base5",
paste0("curs6.",1:5),
"base6",
paste0("curs7.",1:5),
"base7"))
cursLU$type<-substr(cursLU$curs,1,4)
cursLU$oven<-c(
rep("Pyrolysis",7),
rep("Pyrolysis",4),
rep("Pyrolysis",4),
rep("Oxidation",5),
rep("Oxidation",5),
rep("Pyrolysis",6),
rep("Oxidation",6))
cursLU$thermo<-c(
rep("CH",7),
rep("CO",4),
rep("CO2",4),
rep("CO",5),
rep("CO2",5),
rep("SO2",6),
rep("SO2",6))
cursLU$no<-c(
1:6,  0,  1:3,  0,  1:3,  0,  1:4,  0,  1:4,  0,  1:5,  0,  1:5,  0)
usethis::use_data(cursLU, internal = TRUE)
cursLU<-data.frame(
curs=c(
paste0("curs1.",1:6),
"base1",
paste0("curs2.",1:3),
"base2",
paste0("curs3.",1:3),
"base3",
paste0("curs4.",1:4),
"base4",
paste0("curs5.",1:4),
"base5",
paste0("curs6.",1:5),
"base6",
paste0("curs7.",1:5),
"base7"))
cursLU$type<-substr(cursLU$curs,1,4)
cursLU$oven<-c(
rep("Pyrolysis",7),
rep("Pyrolysis",4),
rep("Pyrolysis",4),
rep("Oxidation",5),
rep("Oxidation",5),
rep("Pyrolysis",6),
rep("Oxidation",6))
cursLU$thermo<-c(
rep("CH",7),
rep("CO",4),
rep("CO2",4),
rep("CO",5),
rep("CO2",5),
rep("SO2",6),
rep("SO2",6))
cursLU$no<-c(
1:6,  0,  1:3,  0,  1:3,  0,  1:4,  0,  1:4,  0,  1:5,  0,  1:5,  0)
usethis::use_data(cursLU, internal = TRUE, overwrite = TRUE)
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
test2<-RE_convert(test)
test3<-RE_surfaces(test2)
View(test3)
sample<-test2$S_2501_0001.B00
#1.2 define safe sequence in case of NAs
s.seq<-function(x,y){
if (all(is.na(x))|all(is.na(y))) {NA} else {
seq(x,y,by=1)}
}
tr.s4CO2<-s.seq(min(sample[["Oxidation"]]["t"]),sample[["Cursors"]]["curs5.4"])
tr.s5<-s.seq(sample[["Cursors"]]["curs5.4"],max(sample[["Oxidation"]]["t"]))
sample[["Cursors"]]["curs5.4"]
sample[["Cursors"]]
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
test2<-RE_convert(test)
test3<-RE_surfaces(test2)
sample<-test2$S_2501_0001.B00
View(sample)
View(test3)
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
test2<-RE_convert(test)
test3<-RE_surfaces(test2)
sample<-test2$S_2501_0001.B00
View(test3)
sample[["Cursors"]]
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
test2<-RE_convert(test)
test3<-RE_surfaces(test2)
sample<-test2$S_2501_0001.B00
View(sample)
View(sample)
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
test2<-RE_convert(test)
test3<-RE_surfaces(test2)
sample<-test2$S_2501_0001.B00
plot(test,"S_2501_0001.B00")
RE_plot(test,"S_2501_0001.B00")
sample<-test2$S_2501_0001.B00
RE_traparea(sample[["Oxidation"]][["t"]],sample[["Oxidation"]][["CO"]])
cut<-sample$Oxidation[sample$Oxidation$CO2>550 & sample$Oxidation$CO2<720,]
cut<-sample$Oxidation[sample$Oxidation$CO2>550,]
cut<-sample$Oxidation[sample$Oxidation$T>550,]
cut<-sample$Oxidation[sample$Oxidation$T>550 & sample$Oxidation$T<720,]
time<-cut$t[min(cut$CO2)]
min(cut$CO2)
time<-cut$t[which.min(cut$CO2)]
cut2<-cut[which.min(cut$CO2),]
View(cut2)
cut<-sample$Oxidation[sample$Oxidation$T>550 & sample$Oxidation$T<720,]
View(cut)
cut<-sample$Oxidation[sample$Oxidation$T>550 & sample$Oxidation$T<720 & sample$Oxidation$t<1500,]
time<-cut$t[which.min(cut$CO2)]
sample$Cursors
cursLU<-data.frame(
curs=c(
paste0("curs1.",1:6),
"base1",
paste0("curs2.",1:3),
"base2",
paste0("curs3.",1:3),
"base3",
paste0("curs4.",1:4),
"base4",
paste0("curs5.",1:4),
"base5",
paste0("curs6.",1:5),
"base6",
paste0("curs7.",1:5),
"base7"))
cursLU$type<-substr(cursLU$curs,1,4)
cursLU$oven<-c(
rep("Pyrolysis",7),
rep("Pyrolysis",4),
rep("Pyrolysis",4),
rep("Pyrolysis",5),
rep("Oxidation",5),
rep("Oxidation",6),
rep("Oxidation",6))
cursLU$thermo<-c(
rep("CH",7),
rep("CO",4),
rep("CO2",4),
rep("SO2",5),
rep("CO",5),
rep("CO2",6),
rep("SO2",6))
cursLU$no<-c(
1:6,  0,  1:3,  0,  1:3,  0,  1:4,  0,  1:4,  0,  1:5,  0,  1:5,  0)
usethis::use_data(cursLU, internal = TRUE, overwrite = TRUE)
RE_plot(test,"S_2501_0001.B00")
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
RE_plot(test,"S_2501_0001.B00")
sample<-test2$S_2501_0001.B00
test2<-RE_convert(test)
sample<-test2$S_2501_0001.B00
sample$Cursors
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
RE_plot(test,1)
test2<-RE_convert(test)
test3<-RE_surfaces(test2)
View(test3)
RE_plot(test,1,"Oxidation")
RE_plot(test,1,"Pyrolysis")
devtools::document()
rm(list=ls())
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
RE_plot(test,1,"Pyrolysis")
rm(list=ls())
library(tidyverse)
devtools::load_all()
devtools::load_all()
devtools::load_all()
devtools::load_all()
rm(list=ls())
library(tidyverse)
devtools::load_all()
dataloc<-"D:/PhD/Rock-Eval/Maarten_2501 - Copy/BULK ROCK"
test<-RE_read(dataloc)
RE_plot(test,1,"Pyrolysis")
test2<-RE_convert(test)
test3<-RE_surfaces(test2)
View(test3)
test3$S_2501_0001.B00$Zones_C
test3$S_2501_0054.B00$Zones_C
test3$S_2501_0054.B00$Zones_C==NULL
test2$S_2501_0054.B00$Zones_C==NULL
test2$S_2501_0054.B00$Zones_C
is.null(test2$S_2501_0054.B00$Zones_C)
View(test3)
View(test)
View(test3)
View(test)
View(test3)
sample<-test3[[1]]
sample$Cursors["curs1.2"]
Tmax.t<-which(sample[["Pyrolysis"]][["t"]]==sample[["Cursors"]]["curs1.2"])
Tmax<-sample[["Pyrolysis"]][["T"]][Tmax.t]
max(sample[["Pyrolysis"]][["T"]])
sample$Calibration
sample$Calibration["cal_FID"]
sample$Calibration["cal_FID"]*0.83
Tpeak.t<-which(sample[["Pyrolysis"]][["t"]]==sample[["Cursors"]]["curs1.2"])
Tpeak<-sample[["Pyrolysis"]][["T"]][Tpeak.t]
sample$Calibration
Tmax<-Tpeak+(sample[["Calibration"]]["cal_Tmax"]-sample[["Calibration"]]["cal_Tpeak"])
Tmax<-Tpeak+(sample[["Calibration"]][["cal_Tmax"]]-sample[["Calibration"]][["cal_Tpeak"]])
Tpeak.t<-which(sample[["Pyrolysis"]][["t"]]==sample[["Cursors"]]["curs1.2"])
Tpeak<-sample[["Pyrolysis"]][["T"]][Tpeak.t]
Tmax<-Tpeak+(sample[["Calibration"]][["cal_Tmax"]]-sample[["Calibration"]][["cal_Tpeak"]])
sample[["Cursors"]]
# Something about the Tmax seems to be different from Geoworks value...
Tmax.t<-which(sample[["Pyrolysis"]][["t"]]==sample[["Cursors"]]["curs1.3"])
Tmax.t<-sample[["Pyrolysis"]][["T"]][Tmax.t]
#POC
ROC<-sample[["Zones_C"]][["S4CO"]]*12/(28*10)+
sample[["Zones_C"]][["S4CO2"]]*12/(44*10)
POC<-sample[["Zones_C"]][["S1"]]*0.83+
sample[["Zones_C"]][["S2"]]*0.83+
sample[["Zones_C"]][["S3CO"]]*12/(28*10)+
sample[["Zones_C"]][["S3COi"]]*12/(2*28*10)+
sample[["Zones_C"]][["S3CO2"]]*12/(44*10)
ROC<-sample[["Zones_C"]][["S4CO"]]*12/(28*10)+
sample[["Zones_C"]][["S4CO2"]]*12/(44*10)
TOC<-POC+ROC
POC<-sample[["Zones_C"]][["S1"]]*0.83/10+
sample[["Zones_C"]][["S2"]]*0.83/10+
sample[["Zones_C"]][["S3CO"]]*12/(28*10)+
sample[["Zones_C"]][["S3COi"]]*12/(2*28*10)+
sample[["Zones_C"]][["S3CO2"]]*12/(44*10)
TOC<-POC+ROC
PIC<-sample[["Zones_C"]][["S3COi"]]*12/(2*28*10)+
sample[["Zones_C"]][["S3CO2i"]]*12/(44*10)
RIC<-sample[["Zones_C"]][["S5"]]*12/(44*10)
TIC<-PIC+RIC
sample[["Zones_C"]][["S5"]]
#Hydrogen and oxygen index (plus extra)
HI<-S2/TOC*100
#Hydrogen and oxygen index (plus extra)
HI<-sample[["Zones_C"]][["S2"]]/TOC*100
OI_CO<-sample[["Zones_C"]][["S3CO"]]/TOC*100
OI_CO2<-sample[["Zones_C"]][["S3CO2"]]/TOC*100
OI_tot<-OI_CO+OI_CO2
OI_combi<-OI_CO*16/28+
OI_CO2*32/44
rm(OI_tot)
View(sample)
View(sample)
View(sample)
View(sample)
list.extended<-test3
#2 calculate the parameters
test4<-lapply(list.extended, function(sample)){
#2 calculate the parameters
test4<-lapply(list.extended, function(sample){
#2.1 Temperature parameters
Tpeak.t<-which(sample[["Pyrolysis"]][["t"]]==sample[["Cursors"]]["curs1.2"])
Tpeak<-sample[["Pyrolysis"]][["T"]][Tpeak.t]
# Something about the Tmax seems to be different from Geoworks value...
# Excluded in output for now
Tmax<-Tpeak+(sample[["Calibration"]][["cal_Tmax"]]-sample[["Calibration"]][["cal_Tpeak"]])
#2.2 Pyrolysable, residual and total organic C
POC<-sample[["Zones_C"]][["S1"]]*0.83/10+
sample[["Zones_C"]][["S2"]]*0.83/10+
sample[["Zones_C"]][["S3CO"]]*12/(28*10)+
sample[["Zones_C"]][["S3COi"]]*12/(2*28*10)+
sample[["Zones_C"]][["S3CO2"]]*12/(44*10)
ROC<-sample[["Zones_C"]][["S4CO"]]*12/(28*10)+
sample[["Zones_C"]][["S4CO2"]]*12/(44*10)
TOC<-POC+ROC
#2.2 Pyrolysable, residual and total inorganic C
PIC<-sample[["Zones_C"]][["S3COi"]]*12/(2*28*10)+
sample[["Zones_C"]][["S3CO2i"]]*12/(44*10)
RIC<-sample[["Zones_C"]][["S5"]]*12/(44*10)
TIC<-PIC+RIC
#Hydrogen and oxygen index (plus extra)
HI<-sample[["Zones_C"]][["S2"]]/TOC*100
OI_CO<-sample[["Zones_C"]][["S3CO"]]/TOC*100
OI_CO2<-sample[["Zones_C"]][["S3CO2"]]/TOC*100
OI_combi<-OI_CO*16/28+
OI_CO2*32/44
metrics<-c(Tpeak=Tpeak,
POC=POC, ROC=ROC, TOC=TOC,
PIC=PIC, RIC=RIC, TIC=TIC,
HI=HI,
OI_CO=OI_CO, OI_CO2=OI_CO2, OI_combi=OI_combi)
sample[["Metrics_C"]]<-metrics
sample
})
View(test4)
devtools::document()
devtools::load_all()
?RE_metrics()
devtools::document()
devtools::load_all()
?RE_metrics
devtools::document()
devtools::document
devtools::document()
devtools::load_all()
?RE_metrics
test4<-RE_metrics(test3)
View(test4)
test4<-RE_metrics(test3)
View(test4)
devtools::load_all()
test4<-RE_metrics(test3)
test4<-RE_metrics(test)
test4<-RE_metrics(test2)
?RE_metrics
?RE_plot
devtools::document()
devtools::load_all()
?RE_metrics
