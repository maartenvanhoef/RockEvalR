plot(test8$S_2501_0001.B00$Pyrolysis$POO)
plot(test8$S_2501_0001.B00$Pyrolysis$POH)
plot(test8$S_2501_0001.B00$Pyrolysis$PO)
plot(test8$S_2501_0001.B00$Pyrolysis$PO[1:900])
plot(test8$S_2501_0001.B00$Pyrolysis$PO[1:900],type="l")
plot(test8$S_2501_0001.B00$Pyrolysis$PO[1:900],type="l",col="red3")
plot(test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/test8$S_2501_0001.B00$Pyrolysis$PC,type="l",col="red3")
plot(test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/test8$S_2501_0001.B00$Pyrolysis$PC[1:900],type="l",col="red3")
ablines(test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/test8$S_2501_0001.B00$Pyrolysis$PC[1:900],col="blue3")
lines(test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/test8$S_2501_0001.B00$Pyrolysis$PC[1:900],col="blue3")
plot(test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/test8$S_2501_0001.B00$Pyrolysis$PC[1:900],
type="l",col="red3",
ylim=c(0,1), xlab="Time (s)", ylab="Ratio O/C or H/C")
lines(test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/test8$S_2501_0001.B00$Pyrolysis$PC[1:900],col="blue3")
plot(test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/test8$S_2501_0001.B00$Pyrolysis$PC[1:900]*12/16,
type="l",col="red3",
ylim=c(0,1), xlab="Time (s)", ylab="Molar ratio O/C or H/C")
lines(test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/test8$S_2501_0001.B00$Pyrolysis$PC[1:900]*1/16,col="blue3")
plot((test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/16)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
type="l",col="red3",
ylim=c(0,1), xlab="Time (s)", ylab="Molar ratio O/C or H/C")
lines((test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/1)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),col="blue3")
plot((test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/16)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
type="l",col="red3",
ylim=c(0,4), xlab="Time (s)", ylab="Molar ratio O/C or H/C")
lines((test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/1)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),col="blue3")
plot((test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/16)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
type="l",col="red3",
ylim=c(0,4), xlab="Time (s)", ylab="Molar ratio O/C or H/C")
plot((test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/16)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
type="l",col="red3",
xlab="Time (s)", ylab="Molar ratio O/C or H/C")
plot((test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/1)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
type="l",col="blue3",
xlab="Time (s)", ylab="Molar ratio O/C or H/C"))
plot((test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/1)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
type="l",col="blue3",
xlab="Time (s)", ylab="Molar ratio O/C or H/C")
plot((test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/16)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
type="l",col="red3",
xlab="Time (s)", ylab="Molar ratio O/C or H/C")
plot((test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/1)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
type="l",col="blue3",
xlab="Time (s)", ylab="Molar ratio O/C or H/C")
plot((test8$S_2501_0001.B00$Pyrolysis$PO[1:900])/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]),
type="l",col="red3", xlim = c(0,1)
xlab="Time (s)", ylab="Ratio O/C or H/C")
plot((test8$S_2501_0001.B00$Pyrolysis$PO[1:900])/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]),
type="l",col="red3", xlim = c(0,1),
xlab="Time (s)", ylab="Ratio O/C or H/C")
plot((test8$S_2501_0001.B00$Pyrolysis$PO[1:900])/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]),
type="l",col="red3", ylim = c(0,1),
xlab="Time (s)", ylab="Ratio O/C or H/C")
lines((test8$S_2501_0001.B00$Pyrolysis$PH[1:900])/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]),
col="blue3")
plot((test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/16)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
type="l",col="red3", ylim = c(0,8),
xlab="Time (s)", ylab="Molar ratio O/C or H/C")
lines((test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/1)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
col="blue3")
plot((test8$S_2501_0001.B00$Pyrolysis$PO[1:900]/16)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
type="l",col="red3", ylim = c(0,10),
xlab="Time (s)", ylab="Molar ratio O/C or H/C")
lines((test8$S_2501_0001.B00$Pyrolysis$PH[1:900]/1)/
(test8$S_2501_0001.B00$Pyrolysis$PC[1:900]/12),
col="blue3")
devtools::load_all()
test9<-RE_calculateall(test)
View(test9)
sample<-test9$S_2501_0001.B00
oven<-"Pyrolysis"
thermogram<-"CH"
area<-RE_traparea(sample[[oven]]["t"],sample[[oven]][[thermogram]])
sample[[oven]]["t"]
sample[[oven]][[thermogram]]
area<-RE_traparea(sample[[oven]][["t"]],sample[[oven]][[thermogram]])
vector<-c(300,500)
invector<-c(0,vector)
1:length(invector)-1
tr.i<-which(sample[[oven]][["T"]]>=invector[i] &
sample[[oven]][["T"]]<=invector[i-1])
i<-2
tr.i<-which(sample[[oven]][["T"]]>=invector[i] &
sample[[oven]][["T"]]<=invector[i-1])
invector[i]
invector[i-1]
tr.i<-which(sample[[oven]][["T"]]>=invector[i-1] &
sample[[oven]][["T"]]<=invector[i])
vector<-c(500,700)
invector<-c(0,vector)
tr.i<-which(sample[[oven]][["T"]]>=invector[i-1] &
sample[[oven]][["T"]]<=invector[i])
plot(tr.i)
plot(sample$Pyrolysis$T)
vector[length(vector)-1]
tail(sample[[oven]][["T"]],1)
tail(sample[[oven]][["T"]],1))
tail(sample[[oven]][["T"]],1)
vector<-c(100,300,450,580,600)
if(vector[length(vector)-1]>tail(sample[[oven]][["T"]],1)){
warning("The highest interval is above the cool down temperature, which may give incorrect results.")
}
if(vector[1]<=head(sample[[oven]][["T"]],1)){
warning("The lowest given interval is below the starting temperature, which may give unwanted results. The input range should exclude 0 and max temperature.")
}
dataloc<-"//WURNET.NL/Homes/hoef006/My Documents/- Data/Verwerking/Rock-Eval/240429"
test<-RE_read(dataloc)
rm(list=ls())
library(tidyverse)
devtools::load_all()
devtools::load_all()
rlang::last_trace()
devtools::load_all()
devtools::load_all()
dataloc<-"//WURNET.NL/Homes/hoef006/My Documents/- Data/Verwerking/Rock-Eval/240429"
test<-RE_read(dataloc)
dataloc<-"//WURNET.NL/Homes/hoef006/My Documents/- Data/Verwerking/Rock-Eval/240429"
test<-RE_read(dataloc)
test<-RE_read(dataloc)
test<-RE_read(dataloc)
test<-RE_read(dataloc)
warnings()
sample<-test$`fpom 22013.B00`
plot(sample[["Pyrolysis"]][["CO2"]])
sample<-test$`maom 22013.B00`
plot(sample[["Pyrolysis"]][["CO2"]])
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
temp.curs<-sample[["Pyrolysis"]][["T"]][sample[["Cursors"]]["curs3.2"]]
temp.curs<-sample[["Pyrolysis"]][["T"]][sample[["Cursors"]][["curs3.2"]]]
sample[["Cursors"]]["curs3.2"]
sample<-test$MvH_D15_02.B00
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
curs.Geo<-sample[["Cursors"]]["curs3.2"] #cursor determined by Geoworks
temp.curs<-sample[["Pyrolysis"]][["T"]][sample[["Cursors"]]["curs3.2"]]
temp.curs>=398 & temp.curs<=402
sign(sample[["Pyrolysis"]][["CO2"]])
sign(0)
sign(-1)
sign(5)
sign(-1)
sign(-8)
embed(sign(sample[["Pyrolysis"]][["CO2"]]))
diff(sample[["Pyrolysis"]][["CO2"]])
embed(sign(sample[["Pyrolysis"]][["CO2"]]),2)
embed(sign(diff(sample[["Pyrolysis"]][["CO2"]])),2)
embed(sign(diff(sample[["Pyrolysis"]][["CO2"]])),2)
t<-embed(sign(diff(sample[["Pyrolysis"]][["CO2"]])),2)
idx <- which(rowSums(t) == 0) + 1
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red")
t<-embed(sign(diff(sample[["Pyrolysis"]][["CO2"]])),3)
idx <- which(rowSums(t) == 0) + 1
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red")
t<-embed(sign(diff(sample[["Pyrolysis"]][["CO2"]])),5)
idx <- which(rowSums(t) == 0) + 1
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red")
t<-embed(sign(diff(sample[["Pyrolysis"]][["CO2"]])),1)
idx <- which(rowSums(t) == 0) + 1
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red")
?diff()
t<-embed(sign(diff(sample[["Pyrolysis"]][["CO2"]], lag = 5)),1)
idx <- which(rowSums(t) == 0) + 1
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red")
t<-embed(sign(diff(sample[["Pyrolysis"]][["CO2"]], lag = 2)),1)
idx <- which(rowSums(t) == 0) + 1
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red")
t<-embed(sign(diff(sample[["Pyrolysis"]][["CO2"]], lag = 2, differences = 2)),1)
idx <- which(rowSums(t) == 0) + 1
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red")
t<-embed(sign(diff(sample[["Pyrolysis"]][["CO2"]], lag = 2, differences = 0.1)),1)
diff(sample[["Pyrolysis"]][["CO2"]], lag = 2, differences = 5)
diff(sample[["Pyrolysis"]][["CO2"]], lag = 2, differences = 1)
t<-embed(sign(diff(sample[["Pyrolysis"]][["CO2"]], lag = 2)),1)
t
t
t<-embed(sign(diff(sample[["Pyrolysis"]][["CO2"]], lag = 2, differences=5)),1)
t
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 2, differences=5)
v
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 2, differences=3)
v
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 2, differences=1)
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 5, differences=1)
v
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 2, differences=1)
v2<-v[v>3]
t<-embed(sign(v2),1)
idx <- which(rowSums(t) == 0) + 1
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red")
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 2, differences=1)
v2<-v[v>1]
t<-embed(sign(v2),1)
idx <- which(rowSums(t) == 0) + 1
plot(v)
plot(v,type="l")
abline(h=0)
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 1, differences=1)
plot(v,type="l")
abline(h=0)
which.max(sample[["Pyrolysis"]][["CO2"]])
plot(v,type="l")
abline(h=0)
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]))
plot(v,type="l")
abline(h=0, col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]), col="red2")
which.max(sample[["Pyrolysis"]][["CO2"]][600:800]
)
plot(v,type="l")
abline(h=0, col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]), col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]][600:800]+600), col="red2")
plot(v,type="l")
abline(h=0, col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]), col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]][600:800])+600, col="red2")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
t<-embed(sign(v),1)
idx <- which(rowSums(t) == 0) + 1
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 3, differences=1)
t<-embed(sign(v),1)
idx <- which(rowSums(t) == 0) + 1
plot(v,type="l")
abline(h=0, col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]), col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]][600:800])+600, col="red2")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 5, differences=1)
t<-embed(sign(v),1)
idx <- which(rowSums(t) == 0) + 1
plot(v,type="l")
abline(h=0, col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]), col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]][600:800])+600, col="red2")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 30, differences=1)-
t<-embed(sign(v),1)
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 30, differences=1)
plot(v,type="l")
plot(v,type="l")
plot(v2,type="l")
plot(v,type="l")
plot(v2,type="l")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]), col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]][600:800])+600, col="red2")
abline(h=0, col="red2")
which(v2==0)
which.max(sample[["Pyrolysis"]][["CO2"]]
)
v2[1119]
v2[1110:1130]
v2[1100:1150]
t<-embed(sign(v2),1)
idx <- which(rowSums(t) == 0)
t
t<-embed(sign(v2),2)
idx <- which(rowSums(t) == 0)
idx
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
which.max(sample[["Pyrolysis"]][["CO2"]]
}
which.max(sample[["Pyrolysis"]][["CO2"]])
idx <- which(rowSums(t) == 0) + 15
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 10, differences=1)
t<-embed(sign(v2),2)
idx <- which(rowSums(t) == 0) + 5
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
plot(v2,type="l")
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 30, differences=1)
t<-embed(sign(v2),2)
idx <- which(rowSums(t) == 0) + 5
plot(v2,type="l")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
idx <- which(rowSums(t) == 0) + 15
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 1, differences=1)
t<-embed(sign(v2),2)
idx<-which(rowSums(t) == 0) + 15
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 1, differences=1)
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 30, differences=1)
which(v2==0)
t<-embed(sign(v2),2)
idx<-which(rowSums(t) == 0)
t2<-embed(sign(v2),2)
idx2 <-which(rowSums(t) == 0) + 15
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 1, differences=1)
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 30, differences=1)
t<-embed(sign(v2),2)
idx<-which(rowSums(t) == 0)
t2<-embed(sign(v2),2)
idx2 <-which(rowSums(t2) == 0) + 15
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 10, differences=1)
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 1, differences=1)
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 30, differences=1)
t<-embed(sign(v),2)
idx<-which(rowSums(t) == 0)
t2<-embed(sign(v2),2)
idx2 <-which(rowSums(t2) == 0) + 15
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
points(idx2, sample[["Pyrolysis"]][["CO2"]][idx2], col="blue4")
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 1, differences=1)
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 10, differences=1)
v3<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 30, differences=1)
t<-embed(sign(v),2)
idx<-which(rowSums(t) == 0)
t2<-embed(sign(v2),2)
idx2 <-which(rowSums(t2) == 0) + 5
t3<-embed(sign(v3),2)
idx3 <-which(rowSums(t3) == 0) + 15
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx3, sample[["Pyrolysis"]][["CO2"]][idx3], col="green4")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
points(idx2, sample[["Pyrolysis"]][["CO2"]][idx2], col="blue4")
v2[1100:1150]
t<-embed(sign(v),4)
idx<-which(rowSums(t) == 0)
t2<-embed(sign(v2),4)
idx2 <-which(rowSums(t2) == 0) + 5
t3<-embed(sign(v3),4)
idx3 <-which(rowSums(t3) == 0) + 15
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
points(idx2, sample[["Pyrolysis"]][["CO2"]][idx2], col="blue4")
points(idx3, sample[["Pyrolysis"]][["CO2"]][idx3], col="green4")
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 4, differences=1)
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 10, differences=1)
v3<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 30, differences=1)
#which(v2==0)
t<-embed(sign(v),4)
idx<-which(rowSums(t) == 0) +2
t2<-embed(sign(v2),4)
idx2 <-which(rowSums(t2) == 0) + 5
#idx2
t3<-embed(sign(v3),4)
idx3 <-which(rowSums(t3) == 0) + 15
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
points(idx2, sample[["Pyrolysis"]][["CO2"]][idx2], col="blue4")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
points(idx2, sample[["Pyrolysis"]][["CO2"]][idx2], col="blue4")
points(idx3, sample[["Pyrolysis"]][["CO2"]][idx3], col="green4")
t2a<-embed(sign(v2),1)
idx2a<-which(rowSums(t2a) == 0) +5
points(idx2a, sample[["Pyrolysis"]][["CO2"]][idx2], col="blue4")
points(idx2a, sample[["Pyrolysis"]][["CO2"]][idx2a], col="blue4")
abline(v=curs.Geo)
View(sample)
abline(v=632)
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
abline(v=632)
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
points(idx2a, sample[["Pyrolysis"]][["CO2"]][idx2a], col="blue4")
abline(v=1082)
sample<-test$`fpom 22013.B00`
curs.Geo<-sample[["Cursors"]]["curs3.2"] #cursor determined by Geoworks
temp.curs<-sample[["Pyrolysis"]][["T"]][sample[["Cursors"]]["curs3.2"]]
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 4, differences=1)
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 10, differences=1)
v3<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 30, differences=1)
t<-embed(sign(v),4)
idx<-which(rowSums(t) == 0) +2
t2<-embed(sign(v2),4)
t2a<-embed(sign(v2),1)
idx2 <-which(rowSums(t2) == 0) + 5
idx2a<-which(rowSums(t2a) == 0) +5
t3<-embed(sign(v3),4)
idx3 <-which(rowSums(t3) == 0) + 15
which.max(sample[["Pyrolysis"]][["CO2"]])
plot(v,type="l")
abline(h=0, col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]), col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]][600:800])+600, col="red2")
plot(v2,type="l")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
abline(v=632)
abline(v=1082)
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
points(idx2a, sample[["Pyrolysis"]][["CO2"]][idx2a], col="blue4")
points(idx3, sample[["Pyrolysis"]][["CO2"]][idx3], col="green4")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
points(idx2a, sample[["Pyrolysis"]][["CO2"]][idx2a], col="blue4")
points(idx3, sample[["Pyrolysis"]][["CO2"]][idx3], col="green4")
abline(v=632)
abline(v=1082)
plot(sample[["Pyrolysis"]][["CH"]],type="l")
abline(v=632)
abline(v=1082)
v<-diff(sample[["Pyrolysis"]][["CH"]], lag = 4, differences=1)
v2<-diff(sample[["Pyrolysis"]][["CH"]], lag = 10, differences=1)
v3<-diff(sample[["Pyrolysis"]][["CH"]], lag = 30, differences=1)
t<-embed(sign(v),4)
idx<-which(rowSums(t) == 0) +2
t2<-embed(sign(v2),4)
t2a<-embed(sign(v2),1)
idx2 <-which(rowSums(t2) == 0) + 5
idx2a<-which(rowSums(t2a) == 0) +5
t3<-embed(sign(v3),4)
idx3 <-which(rowSums(t3) == 0) + 15
points(idx, sample[["Pyrolysis"]][["CH"]][idx], col = "red2")
points(idx2a, sample[["Pyrolysis"]][["CH"]][idx2a], col="blue4")
points(idx3, sample[["Pyrolysis"]][["CH"]][idx3], col="green4")
v3<-diff(sample[["Pyrolysis"]][["CH"]], lag = 50, differences=1)
t3<-embed(sign(v3),4)
idx3 <-which(rowSums(t3) == 0) + 25
plot(sample[["Pyrolysis"]][["CH"]],type="l")
points(idx3, sample[["Pyrolysis"]][["CH"]][idx3], col="green4")
v<-diff(sample[["Pyrolysis"]][["CH"]], lag = 4, differences=1)
v2<-diff(sample[["Pyrolysis"]][["CH"]], lag = 10, differences=1)
v3<-diff(sample[["Pyrolysis"]][["CH"]], lag = 30, differences=1)
t<-embed(sign(v),4)
idx<-which(rowSums(t) == 0) +2
t2<-embed(sign(v2),4)
t2a<-embed(sign(v2),1)
idx2 <-which(rowSums(t2) == 0) + 5
idx2a<-which(rowSums(t2a) == 0) +5
t3<-embed(sign(v3),4)
idx3 <-which(rowSums(t3) == 0) + 15
which.max(sample[["Pyrolysis"]][["CH"]])
plot(v,type="l")
abline(h=0, col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]), col="red2")
plot(v2,type="l")
plot(v3,type="l")
abline(h=0, col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]), col="red2")
plot(sample[["Pyrolysis"]][["CH"]],type="l")
points(idx, sample[["Pyrolysis"]][["CH"]][idx], col = "red2")
points(idx2a, sample[["Pyrolysis"]][["CH"]][idx2a], col="blue4")
points(idx3, sample[["Pyrolysis"]][["CH"]][idx3], col="green4")
plot(sample[["Pyrolysis"]][["CH"]],type="l")
points(idx3, sample[["Pyrolysis"]][["CH"]][idx3], col="green4")
points(idx2a, sample[["Pyrolysis"]][["CH"]][idx2a], col="blue4")
points(idx3, sample[["Pyrolysis"]][["CH"]][idx3], col="green4")
v<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 4, differences=1)
v2<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 10, differences=1)
v3<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 30, differences=1)
t<-embed(sign(v),4)
idx<-which(rowSums(t) == 0) +2
t2<-embed(sign(v2),4)
t2a<-embed(sign(v2),1)
idx2 <-which(rowSums(t2) == 0) + 5
idx2a<-which(rowSums(t2a) == 0) +5
t3<-embed(sign(v3),4)
idx3 <-which(rowSums(t3) == 0) + 15
which.max(sample[["Pyrolysis"]][["CO2"]])
plot(v,type="l")
abline(h=0, col="red2")
abline(v=which.max(sample[["Pyrolysis"]][["CO2"]]), col="red2")
plot(v3,type="l")
plot(sample[["Pyrolysis"]][["CH"]],type="l")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
abline(v=632)
abline(v=1082)
points(idx, sample[["Pyrolysis"]][["CH"]][idx], col = "red2")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
abline(v=632)
abline(v=1082)
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
points(idx2a, sample[["Pyrolysis"]][["CO2"]][idx2a], col="blue4")
points(idx3, sample[["Pyrolysis"]][["CO2"]][idx3], col="green4")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
points(idx3, sample[["Pyrolysis"]][["CO2"]][idx3], col="green4")
v3<-diff(sample[["Pyrolysis"]][["CO2"]], lag = 20, differences=1)
t3<-embed(sign(v3),4)
idx3 <-which(rowSums(t3) == 0) + 10
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
abline(v=632)
abline(v=1082)
points(idx, sample[["Pyrolysis"]][["CO2"]][idx], col = "red2")
plot(sample[["Pyrolysis"]][["CO2"]],type="l")
abline(v=632)
abline(v=1082)
points(idx3, sample[["Pyrolysis"]][["CO2"]][idx3], col="green4")
points(idx2a, sample[["Pyrolysis"]][["CO2"]][idx2a], col="blue4")
